
<div ng-controller="event" ng-init="initFirst()">
    <!-- Nav tabs -->
    <ul class="nav nav-tabs">
        <li class="active"><a data-toggle="tab" href="#myAgenda">Mon Agenda</a></li>
        <li><a data-toggle="tab" href="#addEvent">Ajouter un évènement</a></li>
    </ul>

    <!-- Tab panes -->
    <div class="tab-content">
        <div id="myAgenda" class="tab-pane fade in active">
            <script>
                function visibleOrHidden()
                {
                    var sousEventDiv = document.getElementById('divSousEvent');
                    var invit = document.getElementById('divInvitation');
                    
                    if(sousEventDiv.style.display == "none")
                    {
                        sousEventDiv.style.display = "block";
                        invit.style.display = "none";
                    }
                    else
                    {
                        sousEventDiv.style.display = "none";
                        invit.style.display = "block";
                    }
                }
                
            </script>
            
            <div ng-controller="calendarCtrl as calDemo" ng-init="initCalendar()">
                <tab select="renderCalender('myCalendar1');">
                    <div class="alert-success calAlert" ng-show="alertMessage != undefined && alertMessage != ''">
                      <h4>{{alertMessage}}</h4>
                    </div>
                    <div class="calendar" ng-model="eventSources" calendar="myCalendar1" ui-calendar="uiConfig.calendar"></div>
                </tab>
                <!-- <div ui-calendar="uiConfig.calendar" class="span8 calendar" ng-model="eventSources"></div> -->
                
                <!-- Modal -->
                <modal id="text-page" visible="showModal" title="Evènement : {{ titleEvent }}">
                    
                    <div id="divSousEvent" style="display : block;">
                            <table class="table table-striped">
                                <thead>
                                  <tr>
                                    <th>id</th>
                                    <th>Date début</th>
                                    <th>Date fin</th>
                                    <th>intitule</th>
                                    <th>Invitation</th>
                                  </tr>
                                </thead>
                                <tbody>
                                    <tr data-ng-repeat="asefoe in allSousEventForOneEvent">
                                        <td>
                                            {{ asefoe.id }}
                                        </td>
                                        <td>
                                            {{ asefoe.dateDebut }}
                                        </td>
                                        <td>
                                            {{ asefoe.dateFin }}
                                        </td>
                                        <td>
                                            {{ asefoe.intitule }}
                                        </td>
                                        <td>
                                            <button type="button" class="btn btn-default" onclick="visibleOrHidden();" ng-click="infoSousEvent(asefoe.id)">Invitation</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                    </div>
                    <div id="divInvitation" style="display : none;">
                        <h4 class="modal-title" id="myModalLabel">ID Event : {{ idEvent }} and ID SousEvent : {{ idSousEvent }}. Inviter des artistes</h4>
                        <div>


                                  <!-- <p class="lead">A remplacer dans modal invitation multiple. Test binding ctrl : {{ bindCtrl }}</p> -->

          <!--                        <h3>Recherche plusieurs artistes +  com perso pour envoyer invit</h1>-->

          <!--                        <hr>-->
                                  <label>Inviter des artistes</label>
                                  <ui-select multiple ng-model="ctrl.multipleDemo.selectedPeople" theme="bootstrap" ng-disabled="ctrl.disabled" sortable="true" close-on-select="false" style="width: '1000px';">
                                      <ui-select-match placeholder="Chercher des artistes à inviter">
                                          <img style="float:left;border-radius: 25px;" ng-src="{{$item.image}}"  alt="ImageMarchePas" />
                                          {{$item.name}}
                                      </ui-select-match>
                                      <ui-select-choices refresh="refreshArtiste($select.search)" refresh-delay="1000" repeat="person in ctrl.people">
                                          <small>
                                            <img style="float:left;border-radius: 25px;" ng-src="{{person.image}}"  alt="ImageMarchePas" />
                                          </small>
                                        <div style="margin-left: 60px;" ng-bind-html="person.name | highlight: $select.search"></div>
                                        <div style="margin-left: 60px;">BLABLABLABLA</div>
                                    </ui-select-choices>
                                  </ui-select>
                                  selection : {{ ctrl.multipleDemo.selectedPeople }}<br>

                                  <br><br>
                                  <fieldset class="form-group">
                                      <label for="msgPerso">Envoyer un message personnel</label>
                                      <textarea class="form-control" id="msgPerso" ng-model="msgPerso" name="info" rows="2"></textarea>
                                  </fieldset>

          <!--                        <div class="row">
                                      <div class="col-sm-12 text-center">
                                          <button ng-click="sendInvitation()" type="submit" class="btn btn-template-main"><i class="fa fa-paper-plane"></i>Envoyer les invitations</button>
                                      </div>
                                  </div>-->
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" onclick="visibleOrHidden();">Retour</button>
                          <button type="button" class="btn btn-danger" data-dismiss="modal">Fermer</button>
                          <button type="button" ng-click="sendInvitation()" class="btn btn-template-main"><i class="fa fa-paper-plane"></i>Envoyer les invitations</button>
                        </div>
                    </div>
                </modal>
            </div>
        </div>
        
        
        
        
        <div id="addEvent" class="tab-pane fade">
            <div class="alert alert-danger" ng-show="errorAjout">
                {{errorMessage}}
            </div>
            <form name="fen" role="form" ng-submit="addEvent()">
                <fieldset class="form-group">
                    <label for="intitule">Intitulé :</label>
                    <input id="intitule" class="form-control" type="text" ng-model="event.intitule" name="intitule" />
                </fieldset>
                
                <fieldset class="form-group">
                   <label for="description">Description</label>
                   <textarea class="form-control" id="description" ng-model="event.description" name="description" rows="3"></textarea>
                </fieldset>
                
                <div class="container">
                    <div class='col-md-5'>
                        <label for="checkin">Date début</label>
                        <div class="form-group">
                            <div class='input-group date' id='datetimepicker6'>
                                <input type='text' datepicker="" ng-model="event.datetimedebevent" class="form-control" id="checkin" name="checkin" />
                                <span class="input-group-addon">
                                    <span class="glyphicon glyphicon-calendar"></span>
                                </span>
                            </div>
                            <span class="text-danger"> 
                                {{event.datetimedebevent}}                     
                            </span>
                        </div>
                    </div>
                    
                    <div class='col-md-5'>
                        <label for="checkout">Date fin</label>
                        <div class="form-group">
                            <div class='input-group date' id='datetimepicker7'>
                                <input type='text' datepicker="" ng-model="event.datetimefinevent" class="form-control" id="checkout" name="checkout" />
                                <span class="input-group-addon">
                                    <span class="glyphicon glyphicon-calendar"></span>
                                </span>
                            </div>
                        </div>
                        <span class="text-danger"> 
                                {{event.datetimefinevent}}                     
                        </span>
                    </div>
                </div>
                
                
                <fieldset class="form-group">
                   <label for="description">Informations complémentaires</label>
                   <textarea class="form-control" id="info" ng-model="event.info" name="info" rows="3"></textarea>
                </fieldset>
                
                
                <div ng-app="event">
                    <fieldset style="background: #FCFCFC;padding: 16px;border: 1px solid #D5D5D5;box-shadow: 8px 8px 0px #aaa; " data-ng-repeat="choice in choices">
                        <div class="container" disable-all="lastDateTimePickerSousEvent($index)">
                            <div class="row">
                                <div class='col-md-5'>
                                    <label for="checkin">Date début sous-évènement</label>
                                    <div class="form-group">
                                        <div class='input-group date' id="datetimedeb">
                                            <input type='text' class="form-control" sdatepicker="" ng-model="sousEvent.scheckin[$index]" id="scheckin-{{$index}}"/>
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </span>
                                        </div>
                                        <span class="text-danger"> 
                                            {{sousEvent.scheckin[$index]}}                     
                                        </span>
                                    </div>
                                </div>

                                <div class='col-md-5'>
                                    <label for="checkout">Date fin sous-évènement</label>
                                    <div class="form-group">
                                        <div class='input-group date' id="datetimefin">
                                            <input type='text' class="form-control" sdatepicker="" ng-model="sousEvent.scheckout[$index]" id="scheckout-{{$index}}" />
                                            <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-calendar"></span>
                                            </span>
                                        </div>
                                        <span class="text-danger"> 
                                            {{sousEvent.scheckout[$index]}}                     
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class='col-md-10'>
                                    <div class="form-group">
                                        <label for="sdescription">Description</label>
                                        <textarea class="form-control" sinput="" id="sdescription-{{$index}}"  ng-model="sousEvent.sdescription[$index]" name="sdescription" rows="3"></textarea>
                                    </div>
                                    <span class="text-danger"> 
                                        {{sousEvent.sdescription[$index]}}                     
                                    </span>
                                </div>
                            </div>
                            
                            
                            <div class="row">
                                <div class='col-md-2'>
                                    <div class="form-group">
                                        <label for="setage">Etage</label>
                                        <input type="number" min="0" max ="20" class="form-control" sinput="" id="setage-{{$index}}" ng-model="sousEvent.setage[$index]" name="setage-{{$index}}">
                                    </div>
                                    <div role="alert">
                                        <span class="error" ng-show="sousEvent.setage[$index].$error.required">
                                          Required!</span>
                                        <span class="error" ng-show="sousEvent.setage[$index].$error.number">
                                          Not valid number!</span>
                                    </div>
                                    <span class="text-danger"> 
                                        {{sousEvent.setage[$index]}}                     
                                    </span>
                                </div>
                            </div>
                            
                        </div>  
                        <button class="btn btn-danger" ng-show="$last" ng-click="removeChoice()">Supprimer</button>

                    </fieldset>
                    <br>
                    <br>
                    <button type="button" class="btn btn-primary" ng-click="addNewChoice()" ng-disabled="((!event.datetimedebevent) || (!event.datetimefinevent) || (!event.intitule) || (!event.description))">Ajouter</button>

                    <div id="choicesDisplay">
                       {{ choices }}
                    </div>
                    
                    <div id="scheckinDisplay">
                       {{ sousEvent.scheckin }}
                    </div>
                    
                    <div id="scheckoutDisplay">
                       {{ sousEvent.scheckout }}
                    </div>
                    
                    <div id="sdescriptionDisplay">
                       {{ sousEvent.sdescription }}
                    </div>
                    
                    <div id="setageDisplay">
                       {{ sousEvent.setage }}
                    </div>
                    
                </div>
                
                <button type="submit" class="btn btn-template-main" ng-disabled="((!event.datetimedebevent) || (!event.datetimefinevent) || (!event.intitule) || (!event.description))"><i class="fa fa-save"></i> Sauvegarder les évènements</button>
                
            </form>
        </div>
    </div>
</div>
